(function(){"use strict";var e={1508:function(e,o,s){var t=s(3751),n=s(5615),a=s(641);function r(e,o,s,t,n,r){const i=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.Wv)(i)}var i={name:"App"},l=s(6262);const c=(0,l.A)(i,[["render",r]]);var d=c,u=s(5220),h=s(33);const k={class:"search_container"},_={class:"search_button_div"},g={class:"searchbar"},b=["placeholder"],p={style:{display:"flex","flex-direction":"row",gap:"0.7rem"}},v={key:0,class:"no_more_books"},f={key:1,class:"no_more_books"},m={key:2,class:"media_list"},y={class:"media_list_ul"},L=["src"],w=["src"],C={class:"sub_media_list"},E={key:0,class:"sub_media_list_ul"},P={key:0,class:"genre_list"},T={key:1,class:"genre_list"},X={key:1,class:"sub_media_list_ul"},F={class:"book_title"},B={key:0,class:"genre_list"},I={key:1,class:"genre_list"},S=["onClick"],M={class:"pagination_control"},U=["disabled"],O=["disabled"],q=["disabled"],R=["disabled"],N=["disabled"],A=["disabled"],W={key:3,class:"chosen_media"},Q=["src"],D={class:"chosen_media_info"},x={class:"chosen_genre_list"},G={key:0,class:"chosen_genre",style:{}},j={class:"overview"},$={key:4,class:"chosen_media"},K=["src"],V={class:"chosen_media_info"},J={class:"chosen_media_title_div"},H={class:"chosen_media_info_title"},Y={class:"chosen_author_div"},z={class:"authors"},Z={style:{fontWeight:"900"}},ee={class:"star_rating_div"},oe=["onClick","onMouseover"],se=["innerHTML"],te={key:0,class:"chosen_genre_list"},ne={key:0,class:"chosen_genre",style:{"background-color":"grey"}},ae={key:1,class:"chosen_genre_list"},re={class:"overview"};function ie(e,o,s,n,r,i){const l=(0,a.g2)("RecommendModal");return(0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("form",{onSubmit:o[8]||(o[8]=(0,t.D$)((()=>{}),["prevent"])),class:"search"},[(0,a.Lk)("div",_,[(0,a.Lk)("button",{onClick:o[0]||(o[0]=e=>i.toggleMedia("Books")),class:(0,h.C4)([{active:"Books"===r.searchMedia},"book_button"])}," Books",2),(0,a.Lk)("button",{onClick:o[1]||(o[1]=e=>i.toggleMedia("Movies")),class:(0,h.C4)([{active:"Movies"===r.searchMedia},"movie_button"])}," Movies ",2),(0,a.Lk)("button",{onClick:o[2]||(o[2]=e=>i.toggleMedia("TV Shows")),class:(0,h.C4)([{active:"TV Shows"===r.searchMedia},"show_button"])}," TV Shows ",2)]),(0,a.Lk)("div",g,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Search "+r.searchMedia+" - Trending "+r.searchMedia,"onUpdate:modelValue":o[3]||(o[3]=e=>r.query=e),onInput:o[4]||(o[4]=e=>i.search(!0))},null,40,b),[[t.Jo,r.query]]),(0,a.Lk)("button",{onClick:o[5]||(o[5]=(...e)=>i.clearQuery&&i.clearQuery(...e)),class:"clear_button"},"×")]),(0,a.Lk)("div",p,[(0,a.Lk)("button",{class:"rcmnd-button",onClick:o[6]||(o[6]=e=>i.recommendBooks(r.chosenMedia))},"Recommend Books"),(0,a.Lk)("button",{class:"login-btn",onClick:o[7]||(o[7]=(...e)=>i.redirectToLogin&&i.redirectToLogin(...e))},(0,h.v_)(n.userStore.user_id?"Dashboard":"Login"),1)])],32),(0,a.bF)(l,{isVisible:r.isModalVisible,"onUpdate:isVisible":o[9]||(o[9]=e=>r.isModalVisible=e),recommendedBooks:r.rcmndBooks,mediaType:r.searchMedia,mediaName:r.query,loggedUser:i.loggedUser.online_id,onClose:o[10]||(o[10]=e=>r.isModalVisible=!1)},null,8,["isVisible","recommendedBooks","mediaType","mediaName","loggedUser"]),0==r.mediaList.length&&0==r.isLoading&&"Books"==r.searchMedia&&null==r.chosenMedia?((0,a.uX)(),(0,a.CE)("div",v,[o[20]||(o[20]=(0,a.Lk)("p",null,"No more book results",-1)),(0,a.Lk)("button",{onClick:o[11]||(o[11]=e=>i.search(!0))},"Go Back")])):(0,a.Q3)("",!0),0==r.mediaList.length&&0==r.isLoading&&"Books"!==r.searchMedia&&null==r.chosenMedia?((0,a.uX)(),(0,a.CE)("div",f,o[21]||(o[21]=[(0,a.Lk)("p",null,"No results",-1)]))):(0,a.Q3)("",!0),r.mediaList.length>0?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("ul",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.mediaList,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"media_list_li",key:e.id},["Movies"==this.searchMedia||"TV Shows"==this.searchMedia?((0,a.uX)(),(0,a.CE)("img",{key:0,src:"https://image.tmdb.org/t/p/original/"+e.poster_path,alt:"Movie poster",class:"list_img"},null,8,L)):(0,a.Q3)("",!0),"Books"==this.searchMedia?((0,a.uX)(),(0,a.CE)("img",{key:1,src:e.volumeInfo?.imageLinks?.thumbnail,class:"list_img"},null,8,w)):(0,a.Q3)("",!0),(0,a.Lk)("div",C,["Movies"==this.searchMedia||"TV Shows"==this.searchMedia?((0,a.uX)(),(0,a.CE)("ul",E,[(0,a.Lk)("li",null,[o[22]||(o[22]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(e.title||e.name||"Title unavailable"),1)]),(0,a.Lk)("li",null,[o[23]||(o[23]=(0,a.Lk)("b",null,"Released: ",-1)),(0,a.eW)((0,h.v_)(e.release_date||e.first_air_date||"Not specified"),1)]),o[25]||(o[25]=(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"Genres: ")],-1)),e.genre_ids?.length>0?((0,a.uX)(),(0,a.CE)("ul",P,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.genre_ids,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"genre",key:e,style:(0,h.Tr)({backgroundColor:i.getGenreColor(e)})},(0,h.v_)(i.getGenreName(e)),5)))),128))])):((0,a.uX)(),(0,a.CE)("ul",T,o[24]||(o[24]=[(0,a.Lk)("li",{class:"genre",style:{"background-color":"#9b9a9a"}},"Unknown",-1)])))])):"Books"==this.searchMedia?((0,a.uX)(),(0,a.CE)("ul",X,[(0,a.Lk)("li",F,[o[26]||(o[26]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(e?.volumeInfo?.title||"No title available"),1)]),(0,a.Lk)("li",null,[o[27]||(o[27]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(e?.volumeInfo?.publishedDate||"Not specified"),1)]),o[29]||(o[29]=(0,a.Lk)("li",null,[(0,a.Lk)("b",null,"Categories: ")],-1)),e.volumeInfo?.categories?.length>0?((0,a.uX)(),(0,a.CE)("ul",B,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.volumeInfo["categories"],(e=>((0,a.uX)(),(0,a.CE)("li",{class:"genre",style:{"background-color":"grey"},key:e},(0,h.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("ul",I,o[28]||(o[28]=[(0,a.Lk)("li",{class:"genre",style:{"background-color":"#9b9a9a"}},"Unknown",-1)])))])):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:o=>i.select(e),class:"media_list_button"}," Select ",8,S)])])))),128))]),(0,a.Lk)("li",M,[(0,a.Lk)("button",{class:"pagination_control_button_next_prev",disabled:1==this.currentPage,onClick:o[12]||(o[12]=(...e)=>i.prevPage&&i.prevPage(...e))},"<",8,U),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page1?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page1?"bold":""}),disabled:i.page1>r.totalPages,onClick:o[13]||(o[13]=e=>i.changePage(i.page1))},(0,h.v_)(i.page1),13,O),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page2?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page2?"bold":""}),disabled:i.page2>r.totalPages,onClick:o[14]||(o[14]=e=>i.changePage(i.page2))},(0,h.v_)(i.page2),13,q),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page3?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page3?"bold":""}),disabled:i.page3>r.totalPages,onClick:o[15]||(o[15]=e=>i.changePage(i.page3))},(0,h.v_)(i.page3),13,R),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page4?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page4?"bold":""}),disabled:i.page4>r.totalPages,onClick:o[16]||(o[16]=e=>i.changePage(i.page4))},(0,h.v_)(i.page4),13,N),(0,a.Lk)("button",{class:"pagination_control_button_next_prev",disabled:this.currentPage>=r.totalPages,onClick:o[17]||(o[17]=(...e)=>i.nextPage&&i.nextPage(...e))},">",8,A)])])):(0,a.Q3)("",!0),1!=this.show_ChosenMedia||"Movies"!=this.searchMedia&&"TV Shows"!=this.searchMedia?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",W,[(0,a.Lk)("img",{class:"chosen_media_img",src:"https://image.tmdb.org/t/p/original/"+r.chosenMedia.poster_path,alt:"Movie poster"},null,8,Q),(0,a.Lk)("div",D,[(0,a.Lk)("p",null,[o[30]||(o[30]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(r.chosenMedia.title||r.chosenMedia.name),1)]),(0,a.Lk)("p",null,[o[31]||(o[31]=(0,a.Lk)("b",null,"Released: ",-1)),(0,a.eW)(" "+(0,h.v_)(r.chosenMedia.release_date||r.chosenMedia.first_air_date||"Unavailable"),1)]),(0,a.Lk)("ul",x,[o[32]||(o[32]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Genres: ")],-1)),0==r.chosenMedia?.genre_ids?.length?((0,a.uX)(),(0,a.CE)("li",G,"Unknown")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.chosenMedia.genre_ids,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"chosen_genre",style:(0,h.Tr)({backgroundColor:i.getGenreColor(e)}),key:e},(0,h.v_)(i.getGenreName(e)),5)))),128))]),(0,a.Lk)("p",j,[o[33]||(o[33]=(0,a.Lk)("b",null,"Overview: ",-1)),(0,a.eW)(" "+(0,h.v_)(r.chosenMedia.overview||"Description unavailable"),1)])])])),1==this.show_ChosenMedia&&"Books"==this.searchMedia?((0,a.uX)(),(0,a.CE)("div",$,[(0,a.Lk)("img",{class:"chosen_media_img",src:r.chosenMedia.volumeInfo?.imageLinks?.thumbnail,alt:"Movie poster"},null,8,K),(0,a.Lk)("div",V,[(0,a.Lk)("div",J,[(0,a.Lk)("p",H,[o[34]||(o[34]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(r.chosenMedia.volumeInfo["title"]||"Title unavailable"),1)]),(0,a.Lk)("button",{class:"fav_btn",onClick:o[18]||(o[18]=e=>i.addToFavourites(r.chosenMedia))},"Add to Favourites")]),(0,a.Lk)("div",Y,[(0,a.Lk)("ul",z,[o[35]||(o[35]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Authors: ")],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.chosenMedia.volumeInfo?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{key:o},[(0,a.Lk)("span",Z,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("div",ee,[o[36]||(o[36]=(0,a.Lk)("p",null,"Your rating: ",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.stars,(e=>((0,a.uX)(),(0,a.CE)("button",{key:e,onClick:o=>i.rateBook(e),onMouseover:o=>i.hoverStar(e),onMouseleave:o[19]||(o[19]=(...e)=>i.resetHover&&i.resetHover(...e)),class:(0,h.C4)(["star",{hovered:r.hoveredStar>=e,filled:r.rating>=e}])},[(0,a.Lk)("span",{innerHTML:r.hoveredStar>=e||r.rating>=e?"★":"☆"},null,8,se)],42,oe)))),128))])]),(0,a.Lk)("p",null,[o[37]||(o[37]=(0,a.Lk)("b",null,"Published Date: ",-1)),(0,a.eW)(" "+(0,h.v_)(r.chosenMedia.volumeInfo["publishedDate"]||"Not specified"),1)]),r.chosenMedia.volumeInfo?.categories?.length>0?((0,a.uX)(),(0,a.CE)("ul",te,[o[38]||(o[38]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Categories: ")],-1)),0==r.chosenMedia.volumeInfo?.categories?.length?((0,a.uX)(),(0,a.CE)("p",ne,"Unknown")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.chosenMedia.volumeInfo?.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"chosen_genre",style:{"background-color":"grey"},key:e},(0,h.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("ul",ae,o[39]||(o[39]=[(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Categories: ")],-1),(0,a.Lk)("li",{class:"chosen_genre",style:{"background-color":"#9b9a9a"}},"Unknown",-1)]))),(0,a.Lk)("p",re,[o[40]||(o[40]=(0,a.Lk)("b",null,"Description: ",-1)),(0,a.eW)(" "+(0,h.v_)(r.chosenMedia.volumeInfo["description"]||"Description unavailable"),1)])])])):(0,a.Q3)("",!0)])}s(4114);const le=(0,n.nY)("genre",{state:()=>({genreMap:{12:["Adventure","#FFD700"],14:["Fantasy","#8A2BE2"],16:["Animation","#FAA916"],18:["Drama","#1B1F1A"],27:["Horror","#8B0000"],28:["Action","#FF0000"],35:["Comedy","#FF8C00"],36:["History","#808000"],37:["Western","#D2691E"],53:["Thriller","#000080"],80:["Crime","#A9A9A9"],99:["Documentary","#3289D1"],878:["Science Fiction","#228B22"],9648:["Mystery","#800080"],10402:["Music","#FF1493"],10749:["Romance","#FF69B4"],10751:["Family","#DAA520"],10752:["War","#B22222"],10759:["Action & Adventure","#D2B48C"],10762:["Kids","#00BFFF"],10763:["News","#4682B4"],10764:["Reality","#FF4500"],10765:["Sci-Fi & Fantasy","#3A2C8D"],10766:["Soap","#E6A8D7"],10767:["Talk","#808080"],10768:["War & Politics","#556B2F"],10770:["TV Movie","#C71585"]}}),getters:{getGenreById:e=>o=>{const s=e.genreMap[o];return s?s[0]:"Unknown"},getGenreColorById:e=>o=>{const s=e.genreMap[o];return s?s[1]:"#FFFFFF"}}}),ce={key:0,class:"modal-container"},de={class:"modal"},ue={class:"modal-header"},he={key:0,class:"list-container"},ke={key:0,class:"loading"},_e=["src"],ge={class:"books_li_container"},be={class:"books_li_div"},pe={class:"book_div_title"},ve={class:"books_li_authors"},fe={key:0,style:{"padding-right":"0.3rem"}},me={style:{fontWeight:"900"}},ye={class:"books_li_categories"},Le={key:0,class:"category_ul"},we={key:1},Ce=["onClick"],Ee={key:1,class:"chosen_book_div"},Pe={class:"chosen_book_container"},Te=["src"],Xe={class:"chosen_book_div1"},Fe={class:"div1_title"},Be={class:"chosen_book_div1_title"},Ie={class:"chosen_book_authors"},Se={class:"chosen_book_authors_div"},Me={key:0,style:{"padding-right":"0.3rem"}},Ue={style:{fontWeight:"900"}},Oe={class:"star_rating_div_modal"},qe=["onClick","onMouseover"],Re=["innerHTML"],Ne={key:0,class:"chosen_genre_list"},Ae={key:1,class:"chosen_genre_list"};function We(e,o,s,t,n,r){return s.isVisible?((0,a.uX)(),(0,a.CE)("div",ce,[(0,a.Lk)("div",de,[(0,a.Lk)("div",ue,[(0,a.Lk)("p",null,"Recommended books for: "+(0,h.v_)(s.mediaType)+" - "+(0,h.v_)(s.mediaName),1),(0,a.Lk)("div",null,[0==n.show_list?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:o[0]||(o[0]=(...e)=>r.back&&r.back(...e)),class:"back"},"Back")):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:o[1]||(o[1]=(...e)=>r.close&&r.close(...e)),class:"close-button"},"Close")])]),n.show_list?((0,a.uX)(),(0,a.CE)("ul",he,[0==s.recommendedBooks.length?((0,a.uX)(),(0,a.CE)("li",ke," Loading...")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.recommendedBooks,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"books_li",key:e.title},[(0,a.Lk)("img",{src:e.image,class:"book_image"},null,8,_e),(0,a.Lk)("div",ge,[(0,a.Lk)("div",be,[(0,a.Lk)("p",pe,[o[4]||(o[4]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(e.title||"Unavailable"),1)]),(0,a.Lk)("p",null,[o[5]||(o[5]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(e.published_date||"Unavailable"),1)]),(0,a.Lk)("div",ve,[o[6]||(o[6]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Authors: ")],-1)),0==e?.authors?.length?((0,a.uX)(),(0,a.CE)("li",fe,"Unknown")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"padding-right":"0.3rem"},key:o},[(0,a.Lk)("span",me,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("div",ye,[o[8]||(o[8]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Categories:")],-1)),e.categories.length>0?((0,a.uX)(),(0,a.CE)("ul",Le,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"rcmnd_genre",style:{"background-color":"darkblue"},key:e},(0,h.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("ul",we,o[7]||(o[7]=[(0,a.Lk)("li",{style:{"background-color":"#9b9a9a"}},"Unknown",-1)])))])]),(0,a.Lk)("button",{class:"more_info",onClick:o=>r.more_info(e)},"More info",8,Ce)])])))),128))])):(0,a.Q3)("",!0),0==n.show_list?((0,a.uX)(),(0,a.CE)("div",Ee,[(0,a.Lk)("div",Pe,[(0,a.Lk)("img",{src:n.chosen_book.image,class:"chosen_book_image"},null,8,Te),(0,a.Lk)("div",Xe,[(0,a.Lk)("div",Fe,[(0,a.Lk)("p",Be,[o[9]||(o[9]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(n.chosen_book.title||"Unavailable"),1)]),(0,a.Lk)("button",{class:"fav_btn_modal",onClick:o[2]||(o[2]=e=>r.addToFavourites())},"Add to Favourites")]),(0,a.Lk)("ul",Ie,[(0,a.Lk)("div",Se,[o[10]||(o[10]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Authors: ")],-1)),0==n.chosen_book?.authors?.length?((0,a.uX)(),(0,a.CE)("li",Me,"Unknown")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.chosen_book?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{key:o,style:{"margin-left":"0.3rem"}},[(0,a.Lk)("span",Ue,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("div",Oe,[o[11]||(o[11]=(0,a.Lk)("p",null,"Your rating: ",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.stars,(e=>((0,a.uX)(),(0,a.CE)("button",{key:e,onClick:o=>r.rateBook(e),onMouseover:o=>r.hoverStar(e),onMouseleave:o[3]||(o[3]=(...e)=>r.resetHover&&r.resetHover(...e)),class:(0,h.C4)(["star_modal",{hovered:n.hoveredStar>=e,filled:n.rating>=e}])},[(0,a.Lk)("span",{innerHTML:n.hoveredStar>=e||n.rating>=e?"★":"☆"},null,8,Re)],42,qe)))),128))])]),(0,a.Lk)("p",null,[o[12]||(o[12]=(0,a.Lk)("b",null,"Published Date: ",-1)),(0,a.eW)((0,h.v_)(n.chosen_book.published_date||"Unavailable"),1)]),n.chosen_book.categories.length>0?((0,a.uX)(),(0,a.CE)("ul",Ne,[o[13]||(o[13]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Categories: ")],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.chosen_book.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"chosen_genre",style:{"background-color":"grey"},key:e},(0,h.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("ul",Ae,o[14]||(o[14]=[(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Categories: ")],-1),(0,a.Lk)("li",{class:"chosen_genre",style:{"background-color":"#9b9a9a"}},"Unknown",-1)]))),(0,a.Lk)("p",null,[o[15]||(o[15]=(0,a.Lk)("b",null,"Description: ",-1)),(0,a.eW)((0,h.v_)(n.chosen_book.description||"Unavailable"),1)])])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)}var Qe={data(){return{show_list:!0,chosen_book:null,csrfToken:"",stars:[1,2,3,4,5],rating:0,hoveredStar:0}},props:["recommendedBooks","isVisible","mediaType","mediaName","loggedUser"],watch:{isVisible(e){e&&(this.show_list=!0)}},methods:{async fetch_csrf_token(){try{const e=await fetch("http://127.0.0.1:8000/csrf/",{method:"GET",credentials:"include"});if(e.ok){const o=await e.json();this.csrfToken=o.csrfToken,console.log(`Fetched csrf token: ${this.csrfToken}`)}else console.log(`Failed to fetch token, ${e.statusText}`)}catch(e){console.error(`Error fetching token, ${e}`)}},async addToFavourites(){if(this.loggedUser)try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({book:this.chosen_book,action:"add_book"}),credentials:"include"}),o=await e.json();if(!e.ok){if("Book is already added to favourites"!==o.error)throw new Error(`Failed to add book: ${e.status}`);alert("You have already added this book to your favourites")}}catch(e){console.error("Error adding book:",e)}else alert("You have to have an account to favourite a book.")},async fetch_book_rating(){if(this.loggedUser)try{const e=await fetch(`http://127.0.0.1:8000/book-rating/?book_id=${this.chosen_book.id}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch book: ${e.status}`);const o=await e.json();this.rating=o.book_rating||0}catch(e){console.error("Error fetching book:",e)}},async rateBook(e){if(this.loggedUser){this.rating=e;try{const o=await fetch("http://127.0.0.1:8000/book-rating/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({book_id:this.chosen_book.id,book_rating:e}),credentials:"include"});if(!o.ok)throw new Error(`Failed to add book: ${o.status}`)}catch(o){console.error("Error adding book:",o)}}else alert("You need to login to rate a book")},hoverStar(e){this.hoveredStar=e},resetHover(){this.hoveredStar=0},close(){this.$emit("update:isVisible",!1)},more_info(e){this.show_list=!1,this.chosen_book=e,this.fetch_book_rating()},back(){this.show_list=!0}},mounted(){this.fetch_csrf_token()}};const De=(0,l.A)(Qe,[["render",We]]);var xe=De;const Ge=(0,n.nY)("userStore",{state:()=>({user_id:null,username:null,online_id:null,favourite_genres:[]}),actions:{setUser(e,o,s,t){this.user_id=e,this.username=o,this.online_id=s,this.favourite_genres=t,localStorage.setItem("user",JSON.stringify(this.$state))},loadUser(){const e=localStorage.getItem("user");if(e)try{const o=JSON.parse(e);o.user_id?(this.user_id=o.user_id,this.username=o.username,this.online_id=o.online_id,this.favourite_genres=o.favourite_genres):this.clearUser()}catch(o){console.error("Error loading user: ",o),this.clearUser()}},updateUsername(e){this.username=e},updateOnlineID(e){this.online_id=e},updateFavouriteGenres(e){this.favourite_genres=e},clearUser(){localStorage.removeItem("user"),sessionStorage.removeItem("user"),this.user_id=null,this.username=null,this.online_id=null,this.favourite_genres=[]}}});var je={components:{RecommendModal:xe},data(){return{query:"",mediaList:[],searchMedia:"Movies",show_ChosenMedia:!1,chosenMedia:null,currentPage:1,totalPages:1,showPageMultiplier:1,isModalVisible:!1,rcmndBooks:[],csrfToken:"",stars:[1,2,3,4,5],rating:0,hoveredStar:0,isLoading:!1}},setup(){const e=Ge();return{userStore:e}},computed:{genreStore(){return le()},loggedUser(){return{id:this.userStore.user_id||null,online_id:this.userStore.online_id||null,favourite_genres:this.userStore.favourite_genres||[]}},page1(){return 4*this.showPageMultiplier-3},page2(){return 4*this.showPageMultiplier-2},page3(){return 4*this.showPageMultiplier-1},page4(){return 4*this.showPageMultiplier}},methods:{async fetch_csrf_token(){try{const e=await fetch("http://127.0.0.1:8000/csrf/",{method:"GET",credentials:"include"});if(e.ok){const o=await e.json();this.csrfToken=o.csrfToken,console.log(`Fetched csrf token: ${this.csrfToken}`)}else console.log(`Failed to fetch token, ${e.statusText}`)}catch(e){console.error(`Error fetching token, ${e}`)}},async search(e){if(this.isLoading=!0,this.show_ChosenMedia=!1,this.chosenMedia=null,1==e&&(this.currentPage=1,this.showPageMultiplier=1),"Movies"==this.searchMedia)try{const e=await fetch(`http://127.0.0.1:8000/search-movie/?title=${this.query}&page=${this.currentPage}`);if(!e.ok)throw new Error("Failed to fetch data");const o=await e.json();this.mediaList=o.movies||[],this.currentPage=o.current_page||1,this.totalPages=o.total_pages||1}catch(o){console.error("error catching data",o)}else if("TV Shows"==this.searchMedia)try{const e=await fetch(`http://127.0.0.1:8000/search-show/?title=${this.query}&page=${this.currentPage}`);if(!e.ok)throw new Error("Failed to fetch data");const o=await e.json();this.mediaList=o.shows||[],this.currentPage=o.current_page||1,this.totalPages=o.total_pages||1}catch(o){console.error("error catching data",o)}else if("Books"==this.searchMedia)try{const e=await fetch(`http://127.0.0.1:8000/search-book/?title=${this.query}&page=${this.currentPage}`);if(!e.ok)throw new Error("Failed to fetch data");const o=await e.json();this.mediaList=o.books||[],this.currentPage=o.current_page||1,this.totalPages=o.total_pages||1,console.log(o)}catch(o){console.error("error catching data",o)}this.isLoading=!1},async recommendBooks(e){if(null==e)return void alert("Select a media in order to get book recommendations.");this.rcmndBooks=[],this.openModal();let o=new Map,s=[];if("Movies"==this.searchMedia||"TV Shows"==this.searchMedia){for(let o=0;o<e.genre_ids.length;o++)s.push(this.getGenreName(e.genre_ids[o]));o.set("title",e.title||e.name),o.set("description",e.overview),o.set("genre",s)}else"Books"==this.searchMedia&&(o.set("title",e.volumeInfo["title"]),o.set("description",e.volumeInfo["description"]),o.set("genre",e.volumeInfo["categories"]));let t=new URLSearchParams(o),n="http://127.0.0.1:8000/get-recommendations/?"+t.toString();try{const e=await fetch(n);if(!e.ok)throw new Error("Failed to fecth recommendations");const o=await e.json();this.rcmndBooks=o.recommendations||[]}catch(a){console.error("Error fetching recommendations ",a)}},async addToFavourites(e){if(this.userStore.user_id){const s={};s.id=e.id,s.image=e.volumeInfo?.imageLinks?.thumbnail,s.title=e.volumeInfo?.title,s.authors=e.volumeInfo?.authors,s.published_date=e.volumeInfo["publishedDate"]||"Not specified",s.categories=e.volumeInfo?.categories,s.description=e.volumeInfo?.description;try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({book:s,action:"add_book"}),credentials:"include"}),o=await e.json();if(e.ok)alert(o.message);else{if(!o.error)throw new Error(`Failed to add book: ${e.status}`);alert(o.error)}}catch(o){console.error("Error adding book:",o)}}else alert("You have to login to favourite a book.")},async fetch_book_rating(){if(this.userStore.user_id&&"Books"==this.searchMedia)try{const e=await fetch(`http://127.0.0.1:8000/book-rating/?book_id=${this.chosenMedia.id}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch book: ${e.status}`);const o=await e.json();this.rating=o.book_rating||0}catch(e){console.error("Error fetching book:",e)}},async rateBook(e){if(this.userStore.user_id){this.rating=e;try{const o=await fetch("http://127.0.0.1:8000/book-rating/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({book_id:this.chosenMedia?.id,book_rating:e}),credentials:"include"});if(!o.ok)throw new Error(`Failed to add book: ${o.status}`)}catch(o){console.error("Error adding book:",o)}}else alert("You need to login to rate a book")},hoverStar(e){this.hoveredStar=e},resetHover(){this.hoveredStar=0},openModal(){this.isModalVisible=!0},toggleMedia(e){this.currentPage=1,this.showPageMultiplier=1,this.show_ChosenMedia=!1,this.searchMedia=e,this.mediaList=[],this.search(!0)},clearQuery(){this.currentPage=1,this.query="",this.mediaList=[],this.chosenMedia=null,this.show_ChosenMedia=!1,this.search(!0)},select(e){this.show_ChosenMedia=!0,this.chosenMedia=e,this.fetch_book_rating(),this.mediaList=[],this.query=e.title||e.name||e.volumeInfo["title"],this.currentPage=1},getGenreName(e){return this.genreStore.getGenreById(e)},getGenreColor(e){return this.genreStore.getGenreColorById(e)},changePage(e){this.currentPage=e,this.search(!1),window.scrollTo({top:0,behavior:"smooth"})},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.currentPage>this.page4&&this.showPageMultiplier++,this.search(!1),window.scrollTo({top:0,behavior:"smooth"}))},prevPage(){this.page1==this.currentPage?(this.showPageMultiplier--,this.changePage(this.page4)):this.changePage(Number(this.currentPage)-1),this.search(!1),window.scrollTo({top:0,behavior:"smooth"})},redirectToLogin(){this.loggedUser.online_id?window.location.href="/dashboard/":window.location.href="/login/"}},mounted(){this.search(!0),this.fetch_csrf_token()}};const $e=(0,l.A)(je,[["render",ie]]);var Ke=$e;s(8111),s(2489),s(3579);const Ve={class:"page_container"},Je={class:"dashboard_nav"},He={class:"dashboard_container"},Ye={class:"user_info"},ze={key:0,class:"user_info_list"},Ze={class:"user_info_li"},eo={class:"user_info_div"},oo=["placeholder","readonly"],so={key:1,class:"change_div"},to={class:"user_info_li"},no={class:"user_info_div"},ao=["placeholder","readonly"],ro={key:1,class:"change_div"},io={class:"user_info_li"},lo={class:"user_info_div"},co=["placeholder","readonly"],uo={key:1,class:"change_div"},ho={key:1,class:"user_info_list"},ko={class:"user_info_li"},_o={class:"user_password_div"},go=["type"],bo={class:"user_info_li"},po={class:"user_password_div"},vo=["type"],fo={class:"user_info_li"},mo={class:"user_password_div"},yo=["type"],Lo={class:"password_btn_div"},wo={class:"genre_book_container"},Co={class:"add_genre_container"},Eo={class:"genre_div"},Po={class:"user_genre_list"},To={key:0,class:"user_genre",style:{"background-color":"grey"}},Xo=["onClick"],Fo={class:"add_book_container"},Bo={class:"genre_div"},Io={class:"favourite_book_ul"},So={key:0,class:"user_genre",style:{"background-color":"grey"}},Mo=["src"],Uo={class:"favourite_books_li_container"},Oo={class:"favourite_books_li_div"},qo={class:"favourite_book_div_title"},Ro={class:"favourite_book_div_published"},No={class:"favourite_books_li_authors"},Ao={style:{fontWeight:"900"}},Wo={class:"favourite_books_li_categories"},Qo={key:0,class:"favourite_category_ul"},Do={key:1,class:"category_ul_modal"},xo=["onClick"],Go={key:0,class:"genre_modal"},jo={class:"genre_modal_container"},$o={class:"genre_modal_div"},Ko={class:"add_genre_list"},Vo={key:0,class:"add_user_genre",style:{"background-color":"grey"}},Jo=["onClick"],Ho={key:1,class:"genre_modal"},Yo={class:"book_modal_container"},zo={class:"book_modal_container_header"},Zo={key:0,class:"books_ul_container"},es={class:"books_ul"},os={key:0,class:"no_more_books_dashboard"},ss=["src"],ts={class:"books_li_container_modal"},ns={class:"books_li_div_modal"},as={class:"book_div_title_modal"},rs={class:"book_div_published_modal"},is={class:"books_li_authors_modal"},ls={style:{fontWeight:"900"}},cs={class:"books_li_categories_modal"},ds={key:0,class:"category_ul_modal"},us={key:1,class:"category_ul_modal"},hs=["onClick"],ks={key:0,class:"pagination_control_modal"},_s=["disabled"],gs=["disabled"],bs=["disabled"],ps=["disabled"],vs=["disabled"],fs=["disabled"],ms={key:1,class:"chosen_book_div_modal"},ys={class:"chosen_book_container_modal"},Ls=["src"],ws={class:"chosen_book_div1_modal"},Cs={class:"modal_title_div"},Es={class:"modal_title1"},Ps={class:"chosen_book_authors_dashboard"},Ts={class:"chosen_book_authors_dashboard_div"},Xs={style:{fontWeight:"900"}},Fs={class:"star_rating_div_dashboard"},Bs=["onClick","onMouseover"],Is=["innerHTML"],Ss={key:0,class:"chosen_genre_list_modal"},Ms={key:1,class:"chosen_genre_list_modal"};function Us(e,o,s,n,r,i){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",Ve,[o[79]||(o[79]=(0,a.Lk)("h1",null,"User Dashboard",-1)),(0,a.Lk)("div",Je,[(0,a.Lk)("div",null,[(0,a.bF)(l,{to:{name:"Main Page"},class:"nav_btns"},{default:(0,a.k6)((()=>o[45]||(o[45]=[(0,a.eW)("Search Books")]))),_:1}),(0,a.bF)(l,{to:{name:"Social Page"},class:"nav_btns"},{default:(0,a.k6)((()=>o[46]||(o[46]=[(0,a.eW)("Community Page")]))),_:1})]),(0,a.Lk)("button",{onClick:o[0]||(o[0]=(...e)=>i.logout&&i.logout(...e)),class:"logout_btn"},"Logout")]),(0,a.Lk)("div",He,[(0,a.Lk)("div",Ye,[o[53]||(o[53]=(0,a.Lk)("h2",{class:"user_info_header"},"User Information",-1)),0==r.changePassword?((0,a.uX)(),(0,a.CE)("ul",ze,[(0,a.Lk)("li",Ze,[o[47]||(o[47]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Username")],-1)),(0,a.Lk)("div",eo,[(0,a.bo)((0,a.Lk)("input",{class:"user_info_div_input","onUpdate:modelValue":o[1]||(o[1]=e=>r.user_data.username=e),placeholder:r.user_data.username,readonly:r.readUsername,maxlength:"15"},null,8,oo),[[t.Jo,r.user_data.username]]),1==r.readUsername?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"change_btn",onClick:o[2]||(o[2]=(...e)=>i.changeUsername&&i.changeUsername(...e))},"Change")):0==r.readUsername?((0,a.uX)(),(0,a.CE)("div",so,[(0,a.Lk)("button",{onClick:o[3]||(o[3]=(...e)=>i.saveUsername&&i.saveUsername(...e)),class:"save_btn"},"Save"),(0,a.Lk)("button",{onClick:o[4]||(o[4]=(...e)=>i.cancelUsername&&i.cancelUsername(...e)),class:"cancel_btn"},"Cancel")])):(0,a.Q3)("",!0)])]),(0,a.Lk)("li",to,[o[48]||(o[48]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Online ID")],-1)),(0,a.Lk)("div",no,[(0,a.bo)((0,a.Lk)("input",{class:"user_info_div_input","onUpdate:modelValue":o[5]||(o[5]=e=>r.user_data.online_id=e),placeholder:r.user_data.online_id,readonly:r.readOnlineId,maxlength:"15"},null,8,ao),[[t.Jo,r.user_data.online_id]]),1==r.readOnlineId?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"change_btn",onClick:o[6]||(o[6]=(...e)=>i.changeOnlineId&&i.changeOnlineId(...e))},"Change")):0==r.readOnlineId?((0,a.uX)(),(0,a.CE)("div",ro,[(0,a.Lk)("button",{onClick:o[7]||(o[7]=(...e)=>i.saveOnlineId&&i.saveOnlineId(...e)),class:"save_btn"},"Save"),(0,a.Lk)("button",{onClick:o[8]||(o[8]=(...e)=>i.cancelOnlineId&&i.cancelOnlineId(...e)),class:"cancel_btn"},"Cancel")])):(0,a.Q3)("",!0)])]),(0,a.Lk)("li",io,[o[49]||(o[49]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Date of Birth")],-1)),(0,a.Lk)("div",lo,[(0,a.bo)((0,a.Lk)("input",{class:"user_info_div_date","onUpdate:modelValue":o[9]||(o[9]=e=>r.user_data.DOB=e),placeholder:r.user_data.DOB,type:"date",readonly:r.readDOB,max:"2020-01-01"},null,8,co),[[t.Jo,r.user_data.DOB]]),1==r.readDOB?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"change_btn",onClick:o[10]||(o[10]=(...e)=>i.changeDOB&&i.changeDOB(...e))},"Change")):0==r.readDOB?((0,a.uX)(),(0,a.CE)("div",uo,[(0,a.Lk)("button",{onClick:o[11]||(o[11]=(...e)=>i.saveDOB&&i.saveDOB(...e)),class:"save_btn"},"Save"),(0,a.Lk)("button",{onClick:o[12]||(o[12]=(...e)=>i.cancelDOB&&i.cancelDOB(...e)),class:"cancel_btn"},"Cancel")])):(0,a.Q3)("",!0)])]),(0,a.Lk)("button",{class:"change_password_btn",onClick:o[13]||(o[13]=(...e)=>i.change_password&&i.change_password(...e))},"Change Password")])):(0,a.Q3)("",!0),1==r.changePassword?((0,a.uX)(),(0,a.CE)("ul",ho,[(0,a.Lk)("li",ko,[o[50]||(o[50]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Old Password")],-1)),(0,a.Lk)("div",_o,[(0,a.bo)((0,a.Lk)("input",{class:"user_info_div_input","onUpdate:modelValue":o[14]||(o[14]=e=>r.password_form.old_password=e),placeholder:"Enter Old Password",type:r.showOldPassword?"text":"password"},null,8,go),[[t.hp,r.password_form.old_password]]),(0,a.Lk)("button",{class:"show_password_btn",onClick:o[15]||(o[15]=(...e)=>i.show_OldPassword&&i.show_OldPassword(...e))},(0,h.v_)(r.showOldPassword?"Hide":"Show"),1),(0,a.Lk)("button",{class:"clear_password_btn",onClick:o[16]||(o[16]=(...e)=>i.clearOldPassword&&i.clearOldPassword(...e))},"Clear")])]),(0,a.Lk)("li",bo,[o[51]||(o[51]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"New Password")],-1)),(0,a.Lk)("div",po,[(0,a.bo)((0,a.Lk)("input",{class:"user_info_div_input","onUpdate:modelValue":o[17]||(o[17]=e=>r.password_form.new_password_1=e),placeholder:"Enter New Password",type:r.showNewPassword1?"text":"password"},null,8,vo),[[t.hp,r.password_form.new_password_1]]),(0,a.Lk)("button",{class:"show_password_btn",onClick:o[18]||(o[18]=(...e)=>i.show_NewPassword1&&i.show_NewPassword1(...e))},(0,h.v_)(r.showNewPassword1?"Hide":"Show"),1),(0,a.Lk)("button",{class:"clear_password_btn",onClick:o[19]||(o[19]=(...e)=>i.clearNewPassword1&&i.clearNewPassword1(...e))},"Clear")])]),(0,a.Lk)("li",fo,[o[52]||(o[52]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Confirm New Password")],-1)),(0,a.Lk)("div",mo,[(0,a.bo)((0,a.Lk)("input",{class:"user_info_div_input","onUpdate:modelValue":o[20]||(o[20]=e=>r.password_form.new_password_2=e),placeholder:"Re-enter New Password",type:r.showNewPassword2?"text":"password"},null,8,yo),[[t.hp,r.password_form.new_password_2]]),(0,a.Lk)("button",{class:"show_password_btn",onClick:o[21]||(o[21]=(...e)=>i.show_NewPassword2&&i.show_NewPassword2(...e))},(0,h.v_)(r.showNewPassword2?"Hide":"Show"),1),(0,a.Lk)("button",{class:"clear_password_btn",onClick:o[22]||(o[22]=(...e)=>i.clearNewPassword2&&i.clearNewPassword2(...e))},"Clear")])]),(0,a.Lk)("div",Lo,[(0,a.Lk)("button",{onClick:o[23]||(o[23]=(...e)=>i.updatePassword&&i.updatePassword(...e)),class:"update_btn"},"Update Password"),(0,a.Lk)("button",{onClick:o[24]||(o[24]=(...e)=>i.cancelPassword&&i.cancelPassword(...e)),class:"cancel_password_btn"},"Cancel")])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",wo,[(0,a.Lk)("div",Co,[o[55]||(o[55]=(0,a.Lk)("h3",null,"Favourite Genres",-1)),(0,a.Lk)("div",Eo,[o[54]||(o[54]=(0,a.Lk)("p",null,"Your Genres:",-1)),(0,a.Lk)("button",{class:"add_genre_btn",onClick:o[25]||(o[25]=(...e)=>i.openGenreModal&&i.openGenreModal(...e))},"Add Genre")]),(0,a.Lk)("ul",Po,[0==r.user_data.favourite_genres.length?((0,a.uX)(),(0,a.CE)("li",To,"No genres added yet")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.user_data.favourite_genres,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"user_genre",style:(0,h.Tr)({backgroundColor:e[1]})},[(0,a.eW)((0,h.v_)(e[0])+" ",1),(0,a.Lk)("button",{class:"delete_genre_btn",onClick:o=>i.deleteGenre(e[0])},"-",8,Xo)],4)))),128))])]),(0,a.Lk)("div",Fo,[o[62]||(o[62]=(0,a.Lk)("h3",null,"Favourite Books",-1)),(0,a.Lk)("div",Bo,[o[56]||(o[56]=(0,a.Lk)("p",null,"Your Books:",-1)),(0,a.Lk)("button",{class:"add_genre_btn",onClick:o[26]||(o[26]=(...e)=>i.openBookModal&&i.openBookModal(...e))},"Add Book")]),(0,a.Lk)("ul",Io,[0==r.user_data?.favourite_books?.length?((0,a.uX)(),(0,a.CE)("li",So,"No books added yet")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.user_data.favourite_books,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"favourite_book_li",key:e},[(0,a.Lk)("img",{src:e?.image,class:"favourite_book_image"},null,8,Mo),(0,a.Lk)("div",Uo,[(0,a.Lk)("div",Oo,[(0,a.Lk)("p",qo,[o[57]||(o[57]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(e?.title),1)]),(0,a.Lk)("p",Ro,[o[58]||(o[58]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(e?.published_date||"Not specified"),1)]),(0,a.Lk)("div",No,[o[59]||(o[59]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Authors: ")],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"padding-right":"0.3rem"},key:o},[(0,a.Lk)("span",Ao,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("div",Wo,[o[61]||(o[61]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Categories:")],-1)),e?.categories?.length>0?((0,a.uX)(),(0,a.CE)("ul",Qo,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e?.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"rcmnd_genre_modal",style:{"background-color":"darkblue"},key:e},(0,h.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("ul",Do,o[60]||(o[60]=[(0,a.Lk)("li",{class:"rcmnd_genre_modal",style:{"background-color":"#9b9a9a"}},"Unknown",-1)])))])]),(0,a.Lk)("button",{class:"favourite_more_info",onClick:o=>i.moreInfo(e,!0)},"More info",8,xo)])])))),128))])])]),1==r.openAddGenre?((0,a.uX)(),(0,a.CE)("div",Go,[(0,a.Lk)("div",jo,[o[64]||(o[64]=(0,a.Lk)("h4",null,"Add Genres",-1)),(0,a.Lk)("div",$o,[o[63]||(o[63]=(0,a.Lk)("p",null,"Choose from genres below",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":o[27]||(o[27]=e=>r.newGenreName=e),placeholder:"Enter your own genre",maxlength:"25"},null,512),[[t.Jo,r.newGenreName]]),(0,a.Lk)("button",{onClick:o[28]||(o[28]=(...e)=>i.addNewGenre&&i.addNewGenre(...e))},"Add")]),(0,a.Lk)("ul",Ko,[0==r.genreList.filter((e=>!r.user_data.favourite_genres.some((o=>o[0]===e[0])))).length?((0,a.uX)(),(0,a.CE)("li",Vo,"No more genres available to add")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.genreList.filter((e=>!r.user_data.favourite_genres.some((o=>o[0]===e[0])))),(e=>((0,a.uX)(),(0,a.CE)("li",{key:e[0],class:"add_user_genre",style:(0,h.Tr)({backgroundColor:e[1]})},[(0,a.eW)((0,h.v_)(e[0]),1),(0,a.Lk)("button",{onClick:o=>i.addGenre(e[0]),class:"add_existing_genre_btn"},"+",8,Jo)],4)))),128))]),(0,a.Lk)("button",{onClick:o[29]||(o[29]=(...e)=>i.cancelAddGenre&&i.cancelAddGenre(...e)),class:"cancel_add_genre_btn"},"Exit")])])):(0,a.Q3)("",!0),1==r.openAddBook?((0,a.uX)(),(0,a.CE)("div",Ho,[(0,a.Lk)("div",Yo,[(0,a.Lk)("div",zo,[o[65]||(o[65]=(0,a.Lk)("h4",null,"Add Books",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o[30]||(o[30]=e=>r.query=e),onInput:o[31]||(o[31]=e=>i.searchBook(!0)),type:"text",placeholder:"Search Books - Trending Books"},null,544),[[t.Jo,r.query]]),(0,a.Lk)("button",{onClick:o[32]||(o[32]=(...e)=>i.clearQuery&&i.clearQuery(...e)),class:"clear_book_btn"},"×"),0==r.showList?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"book_back_btn",onClick:o[33]||(o[33]=(...e)=>i.backToShowList&&i.backToShowList(...e))},"Back")):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:o[34]||(o[34]=(...e)=>i.exitAddBook&&i.exitAddBook(...e)),class:"cancel_add_book_btn"},"Exit")]),1==r.showList?((0,a.uX)(),(0,a.CE)("ul",Zo,[(0,a.Lk)("div",es,[0==r.searchedBooks.length&&0==r.isLoading?((0,a.uX)(),(0,a.CE)("div",os,[o[66]||(o[66]=(0,a.Lk)("p",null,"No more book results",-1)),(0,a.Lk)("button",{onClick:o[35]||(o[35]=e=>i.searchBook(!0))},"Go Back")])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.searchedBooks,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"books_li_modal",key:e.id},[(0,a.Lk)("img",{src:e.volumeInfo?.imageLinks?.thumbnail,class:"book_image_modal"},null,8,ss),(0,a.Lk)("div",ts,[(0,a.Lk)("div",ns,[(0,a.Lk)("p",as,[o[67]||(o[67]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(e.volumeInfo?.title),1)]),(0,a.Lk)("p",rs,[o[68]||(o[68]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(e.volumeInfo?.publishedDate||"Not specified"),1)]),(0,a.Lk)("div",is,[o[69]||(o[69]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Authors: ")],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.volumeInfo?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"padding-right":"0.3rem"},key:o},[(0,a.Lk)("span",ls,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("div",cs,[o[71]||(o[71]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Categories:")],-1)),e.volumeInfo?.categories?.length>0?((0,a.uX)(),(0,a.CE)("ul",ds,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e?.volumeInfo?.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"rcmnd_genre_modal",style:{"background-color":"darkblue"},key:e},(0,h.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("ul",us,o[70]||(o[70]=[(0,a.Lk)("li",{class:"rcmnd_genre_modal",style:{"background-color":"#9b9a9a"}},"Unknown",-1)])))])]),(0,a.Lk)("button",{class:"more_info_modal",onClick:o=>i.moreInfo(e,!1)},"Select",8,hs)])])))),128))]),0!=r.searchedBooks.length?((0,a.uX)(),(0,a.CE)("ul",ks,[(0,a.Lk)("button",{class:"pagination_control_button_next_prev",disabled:1==this.currentPage,onClick:o[36]||(o[36]=(...e)=>i.prevPage&&i.prevPage(...e))},"<",8,_s),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page1?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page1?"bold":""}),disabled:i.page1>r.totalPages,onClick:o[37]||(o[37]=e=>i.changePage(i.page1))},(0,h.v_)(i.page1),13,gs),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page2?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page2?"bold":""}),disabled:i.page2>r.totalPages,onClick:o[38]||(o[38]=e=>i.changePage(i.page2))},(0,h.v_)(i.page2),13,bs),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page3?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page3?"bold":""}),disabled:i.page3>r.totalPages,onClick:o[39]||(o[39]=e=>i.changePage(i.page3))},(0,h.v_)(i.page3),13,ps),(0,a.Lk)("button",{class:"pagination_control_button_page",style:(0,h.Tr)({backgroundColor:this.currentPage==i.page4?"#41ceaa":"#FBFFFE",fontWeight:this.currentPage==i.page4?"bold":""}),disabled:i.page4>r.totalPages,onClick:o[40]||(o[40]=e=>i.changePage(i.page4))},(0,h.v_)(i.page4),13,vs),(0,a.Lk)("button",{class:"pagination_control_button_next_prev",disabled:this.currentPage>=r.totalPages,onClick:o[41]||(o[41]=(...e)=>i.nextPage&&i.nextPage(...e))},">",8,fs)])):(0,a.Q3)("",!0)])):0==r.showList?((0,a.uX)(),(0,a.CE)("div",ms,[(0,a.Lk)("div",ys,[(0,a.Lk)("img",{src:r.chosen_book?.image,class:"chosen_book_image_modal"},null,8,Ls),(0,a.Lk)("div",ws,[(0,a.Lk)("div",Cs,[(0,a.Lk)("p",Es,[o[72]||(o[72]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(r.chosen_book?.title||"Title unavailable"),1)]),1==i.isBookInFavourites(r.chosen_book)?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"favourite_book_btn",onClick:o[42]||(o[42]=(...e)=>i.deleteFavouriteBook&&i.deleteFavouriteBook(...e))},"Unfavourite")):0==i.isBookInFavourites(r.chosen_book)?((0,a.uX)(),(0,a.CE)("button",{key:1,class:"favourite_book_btn",onClick:o[43]||(o[43]=(...e)=>i.addFavouriteBook&&i.addFavouriteBook(...e))},"Add to Favourites")):(0,a.Q3)("",!0)]),(0,a.Lk)("ul",Ps,[(0,a.Lk)("div",Ts,[o[73]||(o[73]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Authors: ")],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.chosen_book?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{key:o},[(0,a.Lk)("span",Xs,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("div",Fs,[o[74]||(o[74]=(0,a.Lk)("p",null,"Your rating: ",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.stars,(e=>((0,a.uX)(),(0,a.CE)("button",{key:e,onClick:o=>i.rateBook(e),onMouseover:o=>i.hoverStar(e),onMouseleave:o[44]||(o[44]=(...e)=>i.resetHover&&i.resetHover(...e)),class:(0,h.C4)(["star_dashboard",{hovered:r.hoveredStar>=e,filled:r.rating>=e}])},[(0,a.Lk)("span",{innerHTML:r.hoveredStar>=e||r.rating>=e?"★":"☆"},null,8,Is)],42,Bs)))),128))])]),(0,a.Lk)("p",null,[o[75]||(o[75]=(0,a.Lk)("b",null,"Published Date: ",-1)),(0,a.eW)((0,h.v_)(r.chosen_book?.published_date),1)]),r.chosen_book?.categories?.length>0?((0,a.uX)(),(0,a.CE)("ul",Ss,[o[76]||(o[76]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Categories: ")],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.chosen_book?.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{class:"chosen_genre",style:{"background-color":"grey"},key:e},(0,h.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("ul",Ms,o[77]||(o[77]=[(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Categories: ")],-1),(0,a.Lk)("li",{class:"chosen_genre",style:{"background-color":"#9b9a9a"}},"Unknown",-1)]))),(0,a.Lk)("p",null,[o[78]||(o[78]=(0,a.Lk)("b",null,"Description: ",-1)),(0,a.eW)((0,h.v_)(r.chosen_book?.description||"Description unavailable"),1)])])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])])}var Os={name:"DashboardPage",data(){return{user_data:{favourite_genres:[]},password_form:{},csrfToken:"",readUsername:!0,readOnlineId:!0,readDOB:!0,changePassword:!1,showOldPassword:!1,showNewPassword1:!1,showNewPassword2:!1,openAddGenre:!1,openAddBook:!1,genreList:[],newGenreName:"",searchedBooks:[],query:"",currentPage:1,totalPages:1,showList:!0,chosen_book:{},showPageMultiplier:1,rating:0,stars:[1,2,3,4,5],hoveredStar:0,isLoading:!1}},computed:{page1(){return 4*this.showPageMultiplier-3},page2(){return 4*this.showPageMultiplier-2},page3(){return 4*this.showPageMultiplier-1},page4(){return 4*this.showPageMultiplier},userStore(){return Ge()}},methods:{async fetch_csrf_token(){try{const e=await fetch("http://127.0.0.1:8000/csrf/",{method:"GET",credentials:"include"});if(e.ok){const o=await e.json();this.csrfToken=o.csrfToken,console.log(`Fetched csrf token: ${this.csrfToken}`)}else console.log(`Failed to fetch token, ${e.statusText}`)}catch(e){console.error(`Error fetching token, ${e}`)}},async fetch_user(){try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(e.ok){const o=await e.json();this.user_data=o,this.user_data.favourite_genres=o.favourite_genres,this.userStore.setUser(o.id,o.username,o.online_id,o.favourite_genres),console.log("Fetched user data")}}catch(e){console.error(`${e}`)}},async searchBook(e){this.showList=!0,this.chosen_book={},this.isLoading=!0,1==e&&(this.currentPage=1,this.showPageMultiplier=1);try{const e=await fetch(`http://127.0.0.1:8000/search-book/?title=${this.query}&page=${this.currentPage}`);if(!e.ok)throw new Error("Failed to fetch data");const o=await e.json();this.searchedBooks=o.books||[],this.currentPage=o.current_page||1,this.totalPages=o.total_pages||1}catch(o){console.error("error catching data",o)}this.isLoading=!1},async logout(){try{const e=await fetch("http://127.0.0.1:8000/logout/",{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(!e.ok)throw new Error("Failed to logout");const o=await e.json();o.logged_out&&(this.userStore.clearUser(),window.location.href="/login/")}catch(e){console.error("error logging out",e)}},backToShowList(){this.showList=!0,this.chosen_book={}},exitAddBook(){this.openAddBook=!1,this.clearQuery(),this.chosen_book={}},clearQuery(){this.query="",this.searchBook(!0)},changePage(e){this.currentPage=e,this.searchBook(!1)},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.currentPage>this.page4&&this.showPageMultiplier++,this.searchBook(!1))},prevPage(){this.page1==this.currentPage?(this.showPageMultiplier--,this.changePage(this.page4)):this.changePage(Number(this.currentPage)-1),this.searchBook(!1)},openBookModal(){this.openAddBook=!0,this.showList=!0},moreInfo(e,o){0==o?(this.chosen_book.id=e.id,this.chosen_book.image=e.volumeInfo?.imageLinks?.thumbnail,this.chosen_book.title=e.volumeInfo?.title,this.chosen_book.authors=e.volumeInfo?.authors,this.chosen_book.published_date=e.volumeInfo["publishedDate"]||"Not specified",this.chosen_book.categories=e.volumeInfo?.categories,this.chosen_book.description=e.volumeInfo?.description):(this.chosen_book=e,this.openAddBook=!0),this.fetch_book_rating(),this.showList=!1},async addFavouriteBook(){try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({book:this.chosen_book,action:"add_book"}),credentials:"include"}),o=await e.json();if(!e.ok){if("Book is already added to favourites"!==o.error)throw new Error(`Failed to add book: ${e.status}`);alert("You have already added this book to your favourites")}this.fetch_user()}catch(e){console.error("Error adding book:",e)}},async deleteFavouriteBook(){try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({book:this.chosen_book,action:"delete_book"}),credentials:"include"});if(!e.ok)throw new Error(`Failed to remove book: ${e.status}`);this.fetch_user()}catch(e){console.error("Error removing book:",e)}},isBookInFavourites(e){return this.user_data.favourite_books.some((o=>o.title===e.title))},async saveUsername(){try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include",body:JSON.stringify({username:this.user_data.username})});e.ok&&(console.log("Username updated successfully"),this.readUsername=!0,this.fetch_user())}catch(e){console.error("Error updating username:",e)}},changeUsername(){this.readUsername=!1,this.cancelOnlineId(),this.cancelDOB()},cancelUsername(){this.fetch_user(),this.readUsername=!0},async saveOnlineId(){try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include",body:JSON.stringify({online_id:this.user_data.online_id})});e.ok&&(console.log("Online ID updated successfully"),this.readOnlineId=!0,this.fetch_user())}catch(e){console.error("Error updating online ID:",e)}},changeOnlineId(){this.readOnlineId=!1,this.cancelUsername(),this.cancelDOB()},cancelOnlineId(){this.fetch_user(),this.readOnlineId=!0},async saveDOB(){try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include",body:JSON.stringify({DOB:this.user_data.DOB})});e.ok&&(console.log("DOB updated successfully"),this.readDOB=!0,this.fetch_user())}catch(e){console.error("Error updating DOB:",e)}},changeDOB(){this.readDOB=!1,this.cancelUsername(),this.cancelOnlineId()},cancelDOB(){this.fetch_user(),this.readDOB=!0},change_password(){this.cancelUsername(),this.cancelOnlineId(),this.cancelDOB(),this.changePassword=!0},cancelPassword(){this.password_form.old_password="",this.password_form.new_password_1="",this.password_form.new_password_2="",this.changePassword=!1},async updatePassword(){try{const e=await fetch("http://127.0.0.1:8000/user/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include",body:JSON.stringify({action:"change_password",old_password:this.password_form.old_password,new_password1:this.password_form.new_password_1,new_password2:this.password_form.new_password_2})}),o=await e.json();if(!e.ok){let e=Object.values(o.errors||{}).flat().join("\n");throw new Error(e||"Unexpected error occured when changing password")}this.cancelPassword()}catch(e){console.error("Error:",e),alert(e)}},show_OldPassword(){this.showOldPassword=!this.showOldPassword},show_NewPassword1(){this.showNewPassword1=!this.showNewPassword1},show_NewPassword2(){this.showNewPassword2=!this.showNewPassword2},clearOldPassword(){this.password_form.old_password=""},clearNewPassword1(){this.password_form.new_password_1=""},clearNewPassword2(){this.password_form.new_password_2=""},openGenreModal(){this.openAddGenre=!0},async deleteGenre(e){try{const o=await fetch("http://127.0.0.1:8000/user/",{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({genre_name:e,action:"delete_genre"}),credentials:"include"});if(!o.ok)throw new Error(`Failed to remove genre: ${o.status}`);this.fetch_user()}catch(o){console.error("Error removing genre:",o)}},async addGenre(e){try{const o=await fetch("http://127.0.0.1:8000/user/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({genre_name:e,action:"add_genre"}),credentials:"include"});if(!o.ok)throw new Error(`Failed to add genre: ${o.status}`);this.fetch_user()}catch(o){console.error("Error adding genre:",o)}},async addNewGenre(){if(this.newGenreName&&0!=this.newGenreName.trim().length)try{const e=await fetch("http://127.0.0.1:8000/genre/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({genre_name:this.newGenreName}),credentials:"include"});if(!e.ok)throw new Error(`Failed to add new genre: ${e.status}`);let o=await e.json(),s=o.genre_name;this.addGenre(s),this.newGenreName="",this.fetch_user(),this.fetch_genres()}catch(e){console.error("Error adding new genre:",e),alert("Error:"+e.message)}else alert("Please provide a new genre name")},async fetch_genres(){try{const e=await fetch("http://127.0.0.1:8000/genre/",{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch genres: ${e.status}`);this.genreList=await e.json()}catch(e){console.error("Error fetching genres:",e)}},cancelAddGenre(){this.openAddGenre=!1},async fetch_book_rating(){try{const e=await fetch(`http://127.0.0.1:8000/book-rating/?book_id=${this.chosen_book.id}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(!e.ok)throw new Error(`Failed to fetch book: ${e.status}`);const o=await e.json();this.rating=o.book_rating||0}catch(e){console.error("Error fetching book:",e)}},async rateBook(e){this.rating=e;try{const o=await fetch("http://127.0.0.1:8000/book-rating/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({book_id:this.chosen_book.id,book_rating:e}),credentials:"include"});if(!o.ok)throw new Error(`Failed to add book: ${o.status}`)}catch(o){console.error("Error adding book:",o)}},hoverStar(e){this.hoveredStar=e},resetHover(){this.hoveredStar=0}},async mounted(){await this.fetch_csrf_token(),this.fetch_user(),this.fetch_genres(),this.searchBook()}};const qs=(0,l.A)(Os,[["render",Us]]);var Rs=qs;const Ns={class:"social_container"},As={class:"user_list_container"},Ws={class:"sort_filter_container"},Qs={class:"sort_by_container"},Ds={class:"filter_by_container"},xs={key:0,class:"user_box_not_found"},Gs={class:"user_box_header"},js={key:0,class:"add_friend_btn"},$s=["onClick"],Ks={class:"user_list_genre_container"},Vs={key:0,class:"user_list_genre"},Js=["onClick"],Hs={key:0,class:"other_user_modal"},Ys={class:"other_user_modal_container"},zs={class:"other_user_modal_header"},Zs={key:0},et={key:1},ot={key:2},st={class:"header_button_div"},tt=["onClick"],nt={key:0,class:"other_user_info_div"},at={class:"other_user_info_div_header"},rt={class:"other_user_genre_container"},it={key:0,class:"other_user_genre"},lt={class:"other_user_book_container"},ct={key:0},dt=["src"],ut={class:"other_user_book_info_div"},ht={class:"other_user_book_info_title"},kt={class:"other_user_book_info_authors"},_t={key:0},gt={style:{fontWeight:"900"}},bt={class:"other_user_book_info_genres"},pt={key:0,style:{"background-color":"grey"},class:"other_book_genre"},vt=["onClick"],ft={class:"other_user_book_container"},mt={key:0,class:"not_shared_books"},yt=["src"],Lt={class:"other_user_book_info_div"},wt={class:"other_user_book_info_title"},Ct={class:"other_user_book_info_authors"},Et={key:0},Pt={style:{fontWeight:"900"}},Tt={class:"other_user_book_info_genres"},Xt={key:0,style:{"background-color":"grey"},class:"other_book_genre"},Ft={class:"share_btn_div"},Bt=["onClick"],It=["onClick"],St={key:1,class:"more_info_book_div"},Mt=["src"],Ut={class:"more_info_info_div"},Ot={class:"more_info_info_authors"},qt={key:0},Rt={style:{fontWeight:"900"}},Nt={class:"more_info_info_genres_container"},At={key:0,style:{"background-color":"grey"},class:"more_info_info_genre"},Wt={style:{"margin-top":"0.5rem"}},Qt={key:2,class:"sharebooks_div"},Dt={class:"searchbar_share"},xt={class:"search_sharebooks_ul"},Gt={key:0,class:"loading_li"},jt={key:1,class:"loading_li"},$t=["src"],Kt={class:"other_user_book_info_div"},Vt={class:"other_user_book_info_title"},Jt={class:"other_user_book_info_authors"},Ht={key:0},Yt={style:{fontWeight:"900"}},zt={class:"other_user_book_info_genres"},Zt={key:0,style:{"background-color":"grey"},class:"other_book_genre"},en=["onClick"],on={class:"pagination_container"},sn=["disabled"],tn=["disabled"],nn={class:"other_container"},an={class:"social_page_nav"},rn={class:"friend_request_container"},ln={class:"friend_request_btn_container"},cn={class:"friend_request_type_btns"},dn=["disabled"],un=["disabled"],hn={class:"friend_request_status_btns"},kn=["disabled"],_n=["disabled"],gn={key:0,class:"friend_request_ul"},bn={key:0},pn={key:1,class:"request_action_btns"},vn=["onClick"],fn=["onClick"],mn={key:0,class:"no_request_li"},yn={key:1,class:"friend_request_ul1"},Ln={key:0},wn={key:1},Cn={key:0,class:"no_request_li"},En={class:"received_books_container"},Pn={class:"received_books_ul"},Tn={key:0,class:"not_shared_books"},Xn=["src"],Fn={class:"received_user_book_info_div"},Bn={class:"received_user_book_info_title"},In={class:"received_user_book_info_authors"},Sn={key:0},Mn={style:{fontWeight:"900"}},Un={class:"received_user_book_info_genres"},On={key:0,style:{"background-color":"grey"},class:"received_book_genre"},qn=["onClick"],Rn={key:0,class:"other_user_modal"},Nn={class:"other_user_modal_container"},An={class:"other_user_modal_header"},Wn={class:"more_info_book_div"},Qn=["src"],Dn={class:"more_info_info_div"},xn={class:"more_info_info_authors"},Gn={key:0},jn={style:{fontWeight:"900"}},$n={class:"more_info_info_genres_container"},Kn={key:0,style:{"background-color":"grey"},class:"more_info_info_genre"},Vn={style:{"margin-top":"0.5rem"}};function Jn(e,o,s,n,r,i){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",Ns,[(0,a.Lk)("div",As,[o[43]||(o[43]=(0,a.Lk)("h1",null,"Other Users",-1)),(0,a.Lk)("div",Ws,[(0,a.Lk)("div",Qs,[(0,a.Lk)("button",{class:"sort_button",onClick:o[0]||(o[0]=(...e)=>i.fetch_all_user&&i.fetch_all_user(...e))},"Sort by"),(0,a.bo)((0,a.Lk)("select",{class:"sort_select","onUpdate:modelValue":o[1]||(o[1]=e=>r.sortBy=e)},o[18]||(o[18]=[(0,a.Lk)("option",{value:"Most Common"},"Most Common Genres",-1),(0,a.Lk)("option",{value:"Least Common"},"Least Common Genres ",-1)]),512),[[t.u1,r.sortBy]])]),(0,a.Lk)("div",Ds,[(0,a.Lk)("button",{class:"filter_button",onClick:o[2]||(o[2]=(...e)=>i.fetch_all_user&&i.fetch_all_user(...e))},"Filter"),o[19]||(o[19]=(0,a.Lk)("label",null,"Min age:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",min:"10",max:"100","onUpdate:modelValue":o[3]||(o[3]=e=>r.minAge=e)},null,512),[[t.Jo,r.minAge,void 0,{number:!0}]]),o[20]||(o[20]=(0,a.Lk)("label",null,"Max age:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=e=>r.maxAge=e),min:"10",max:"100"},null,512),[[t.Jo,r.maxAge,void 0,{number:!0}]]),(0,a.Lk)("button",{class:"reset_button",onClick:o[5]||(o[5]=(...e)=>i.reset&&i.reset(...e))},"Reset")])]),0==r.userList.length?((0,a.uX)(),(0,a.CE)("li",xs," No users found")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.userList,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"user_box"},[(0,a.Lk)("div",Gs,[(0,a.Lk)("p",null,[o[21]||(o[21]=(0,a.Lk)("b",null,"Online ID: ",-1)),(0,a.eW)((0,h.v_)(e.online_id),1)]),1==e.is_friend?((0,a.uX)(),(0,a.CE)("button",js,"Friend")):(0,a.Q3)("",!0),0==e.is_friend?((0,a.uX)(),(0,a.CE)("button",{key:1,class:"add_friend_btn",onClick:o=>i.sendFriendRequest(e.id)},"Add Friend",8,$s)):(0,a.Q3)("",!0)]),o[42]||(o[42]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Favourite genres:")],-1)),(0,a.Lk)("ul",Ks,[0==e.favourite_genres.length?((0,a.uX)(),(0,a.CE)("li",Vs,"No genres added yet")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.favourite_genres,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,style:(0,h.Tr)({backgroundColor:e[1]}),class:"user_list_genre"},(0,h.v_)(e[0]),5)))),128))]),(0,a.Lk)("button",{class:"view_more_btn",onClick:o=>i.viewMore(e)},"View More",8,Js),1==e.showMore?((0,a.uX)(),(0,a.CE)("div",Hs,[(0,a.Lk)("div",Ys,[(0,a.Lk)("div",zs,[0==r.showMoreInfo&&0==r.showShareBooks?((0,a.uX)(),(0,a.CE)("h1",Zs,"User Profile")):(0,a.Q3)("",!0),1==r.showMoreInfo?((0,a.uX)(),(0,a.CE)("h1",et,"Book Information")):(0,a.Q3)("",!0),1==r.showShareBooks?((0,a.uX)(),(0,a.CE)("h1",ot,"Share books with "+(0,h.v_)(e.online_id),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",st,[1==r.showMoreInfo||1==r.showShareBooks?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:o[6]||(o[6]=(...e)=>i.backPage&&i.backPage(...e)),class:"back_btn"},"Back")):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:o=>i.closeViewMore(e),class:"close_btn"},"Close",8,tt)])]),0==r.showMoreInfo&&0==r.showShareBooks?((0,a.uX)(),(0,a.CE)("div",nt,[(0,a.Lk)("div",at,[(0,a.Lk)("p",null,[o[22]||(o[22]=(0,a.Lk)("b",null,"Online ID: ",-1)),(0,a.eW)((0,h.v_)(e.online_id),1)]),(0,a.Lk)("button",{class:"share_book_btn",onClick:o[7]||(o[7]=(...e)=>i.openShareBook&&i.openShareBook(...e))},"Share Books")]),o[31]||(o[31]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Favourite Genres:")],-1)),(0,a.Lk)("ul",rt,[0==e.favourite_genres.length?((0,a.uX)(),(0,a.CE)("li",it,"No genres added yet")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.favourite_genres,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,style:(0,h.Tr)({backgroundColor:e[1]}),class:"other_user_genre"},(0,h.v_)(e[0]),5)))),128))]),o[32]||(o[32]=(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Favourite Books:")],-1)),(0,a.Lk)("ul",lt,[0==e.favourite_books.length?((0,a.uX)(),(0,a.CE)("li",ct," User has not favourited any books yet")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.favourite_books,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"other_user_book_li"},[(0,a.Lk)("img",{src:e.image,class:"other_user_book_img"},null,8,dt),(0,a.Lk)("div",ut,[(0,a.Lk)("p",ht,[o[23]||(o[23]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(e.title||"Unavailable"),1)]),(0,a.Lk)("p",null,[o[24]||(o[24]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(e.published_date||"Unavailable"),1)]),(0,a.Lk)("ul",kt,[o[25]||(o[25]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Authors: ")],-1)),e.authors&&0!==e.authors.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",_t,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"text-align":"left"},key:o},[(0,a.Lk)("span",gt,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("ul",bt,[o[26]||(o[26]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Genres: ")],-1)),e.categories&&0!==e.categories.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",pt,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"other_book_genre"},(0,h.v_)(e),1)))),128))]),(0,a.Lk)("button",{onClick:o=>i.moreInfo(e),class:"other_book_more_info_btn"},"More Info",8,vt)])])))),128))]),(0,a.Lk)("p",null,[(0,a.Lk)("b",null,"Books you have shared with "+(0,h.v_)(e.online_id)+":",1)]),(0,a.Lk)("ul",ft,[0==r.sharedBooks.length?((0,a.uX)(),(0,a.CE)("li",mt," You have not shared books yet")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.sharedBooks,(s=>((0,a.uX)(),(0,a.CE)("li",{key:s,class:"other_user_book_li"},[(0,a.Lk)("img",{src:s.image,class:"other_user_book_img"},null,8,yt),(0,a.Lk)("div",Lt,[(0,a.Lk)("p",wt,[o[27]||(o[27]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(s.title||"Unavailable"),1)]),(0,a.Lk)("p",null,[o[28]||(o[28]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(s.published_date||"Unavailable"),1)]),(0,a.Lk)("ul",Ct,[o[29]||(o[29]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Authors: ")],-1)),s.authors&&0!==s.authors.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",Et,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"text-align":"left"},key:o},[(0,a.Lk)("span",Pt,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("ul",Tt,[o[30]||(o[30]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Genres: ")],-1)),s.categories&&0!==s.categories.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",Xt,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"other_book_genre"},(0,h.v_)(e),1)))),128))]),(0,a.Lk)("div",Ft,[(0,a.Lk)("button",{onClick:e=>i.moreInfo(s),class:"other_book_share_more_info_btn"},"More Info",8,Bt),(0,a.Lk)("button",{class:"unshare_btn",onClick:o=>i.unshare(e.id,s)},"Unshare",8,It)])])])))),128))])])):(0,a.Q3)("",!0),1==r.showMoreInfo?((0,a.uX)(),(0,a.CE)("div",St,[(0,a.Lk)("img",{src:r.moreInfoBook.image,class:"more_info_book_img"},null,8,Mt),(0,a.Lk)("div",Ut,[(0,a.Lk)("p",null,[o[33]||(o[33]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(r.moreInfoBook.title||"Unavailable"),1)]),(0,a.Lk)("p",null,[o[34]||(o[34]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(r.moreInfoBook.published_date||"Unavailable"),1)]),(0,a.Lk)("ul",Ot,[o[35]||(o[35]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Authors: ")],-1)),r.moreInfoBook.authors&&0!==r.moreInfoBook.authors.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",qt,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.moreInfoBook?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"text-align":"left"},key:o},[(0,a.Lk)("span",Rt,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("ul",Nt,[o[36]||(o[36]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Genres: ")],-1)),r.moreInfoBook.categories&&0!==r.moreInfoBook.categories.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",At,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.moreInfoBook.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"more_info_info_genre"},(0,h.v_)(e),1)))),128))]),(0,a.Lk)("p",Wt,[o[37]||(o[37]=(0,a.Lk)("b",null,"Description: ",-1)),(0,a.eW)((0,h.v_)(r.moreInfoBook.description||"Unavailable"),1)])])])):(0,a.Q3)("",!0),1==r.showShareBooks?((0,a.uX)(),(0,a.CE)("div",Qt,[(0,a.Lk)("div",Dt,[(0,a.bo)((0,a.Lk)("input",{type:"text",placeholder:"Search books to share - Trending Books","onUpdate:modelValue":o[8]||(o[8]=e=>r.query=e),onInput:o[9]||(o[9]=e=>i.search(!0))},null,544),[[t.Jo,r.query]]),(0,a.Lk)("button",{onClick:o[10]||(o[10]=(...e)=>i.clearQuery&&i.clearQuery(...e)),class:"clear_button_share"},"×")]),(0,a.Lk)("ul",xt,[1==r.isLoading&&0==r.mediaList.length?((0,a.uX)(),(0,a.CE)("li",Gt,"Loading...")):(0,a.Q3)("",!0),0==r.mediaList.length&&0==r.isLoading?((0,a.uX)(),(0,a.CE)("li",jt," No results")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.mediaList,(s=>((0,a.uX)(),(0,a.CE)("li",{key:s,class:"other_user_book_li"},[(0,a.Lk)("img",{src:s.volumeInfo?.imageLinks?.thumbnail,class:"other_user_book_img"},null,8,$t),(0,a.Lk)("div",Kt,[(0,a.Lk)("p",Vt,[o[38]||(o[38]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(s?.volumeInfo?.title||"No title available"),1)]),(0,a.Lk)("p",null,[o[39]||(o[39]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(s?.volumeInfo?.publishedDate||"Not specified"),1)]),(0,a.Lk)("ul",Jt,[o[40]||(o[40]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Authors: ")],-1)),s.volumeInfo?.authors&&0!==s.volumeInfo?.authors.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",Ht,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.volumeInfo?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"text-align":"left"},key:o},[(0,a.Lk)("span",Yt,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("ul",zt,[o[41]||(o[41]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Genres: ")],-1)),s.volumeInfo?.categories&&0!==s.volumeInfo.categories.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",Zt,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.volumeInfo?.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"other_book_genre"},(0,h.v_)(e),1)))),128))]),(0,a.Lk)("button",{onClick:o=>i.share(e.id,s),class:"other_book_more_info_btn"},"Share Book",8,en)])])))),128))])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])))),128)),(0,a.Lk)("div",on,[(0,a.Lk)("button",{disabled:0==r.hasPrevious,onClick:o[11]||(o[11]=e=>i.prevPage()),class:"pagination_button"},"Previous",8,sn),(0,a.Lk)("button",{disabled:0==r.hasNext,onClick:o[12]||(o[12]=e=>i.nextPage()),class:"pagination_button"},"Next",8,tn)])]),(0,a.Lk)("div",nn,[(0,a.Lk)("nav",an,[(0,a.bF)(l,{class:"nav_btn_dashboard",to:{name:"Dashboard Page"}},{default:(0,a.k6)((()=>o[44]||(o[44]=[(0,a.eW)("Dashboard")]))),_:1}),(0,a.bF)(l,{class:"nav_btn_search_books",to:{name:"Main Page"}},{default:(0,a.k6)((()=>o[45]||(o[45]=[(0,a.eW)("Search Books")]))),_:1})]),(0,a.Lk)("div",rn,[o[51]||(o[51]=(0,a.Lk)("h2",null,"Your Inbox",-1)),(0,a.Lk)("div",ln,[(0,a.Lk)("div",cn,[(0,a.Lk)("button",{class:(0,h.C4)(["friend_request_type_button1",{active:"incoming request"===r.showRequestType}]),disabled:"incoming request"===r.showRequestType,onClick:o[13]||(o[13]=e=>r.showRequestType="incoming request")},"Incoming",10,dn),(0,a.Lk)("button",{class:(0,h.C4)(["friend_request_type_button2",{active:"outgoing request"===r.showRequestType}]),disabled:"outgoing request"===r.showRequestType,onClick:o[14]||(o[14]=e=>r.showRequestType="outgoing request")},"Outgoing",10,un)]),(0,a.Lk)("div",hn,[(0,a.Lk)("button",{class:(0,h.C4)(["friend_request_status_button1",{active:"pending"===r.showRequestStatus}]),disabled:"pending"===r.showRequestStatus,onClick:o[15]||(o[15]=e=>r.showRequestStatus="pending")},"Pending",10,kn),(0,a.Lk)("button",{class:(0,h.C4)(["friend_request_status_button2",{active:"declined"===r.showRequestStatus}]),disabled:"declined"===r.showRequestStatus,onClick:o[16]||(o[16]=e=>r.showRequestStatus="declined")},"Declined",10,_n)])]),"incoming request"===r.showRequestType&&"pending"===r.showRequestStatus?((0,a.uX)(),(0,a.CE)("ul",gn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.friendRequestList.filter((e=>e.type==r.showRequestType&&e.status==r.showRequestStatus)),(e=>((0,a.uX)(),(0,a.CE)("li",{class:"friend_request_li",key:e},["incoming request"==e.type?((0,a.uX)(),(0,a.CE)("p",bn,[o[46]||(o[46]=(0,a.Lk)("b",null,"From: ",-1)),(0,a.eW)((0,h.v_)(e.from_user_online_id),1)])):(0,a.Q3)("",!0),(0,a.Lk)("p",null,[o[47]||(o[47]=(0,a.Lk)("b",null,"Status: ",-1)),(0,a.eW)((0,h.v_)(e.status),1)]),"incoming request"==e.type&&"pending"==e.status?((0,a.uX)(),(0,a.CE)("div",pn,[(0,a.Lk)("button",{onClick:o=>i.acceptRequest(e.id),class:"accept_btn"}," Accept",8,vn),(0,a.Lk)("button",{onClick:o=>i.declineRequest(e.id),class:"decline_btn"}," Decline",8,fn)])):(0,a.Q3)("",!0)])))),128)),0==r.friendRequestList.filter((e=>e.type==r.showRequestType&&e.status==r.showRequestStatus)).length?((0,a.uX)(),(0,a.CE)("li",mn," No Requests ")):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"incoming request"!=r.showRequestType||"pending"!=r.showRequestStatus?((0,a.uX)(),(0,a.CE)("ul",yn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.friendRequestList.filter((e=>e.type==r.showRequestType&&e.status==r.showRequestStatus)),(e=>((0,a.uX)(),(0,a.CE)("li",{class:"friend_request_li1",key:e},["incoming request"==e.type?((0,a.uX)(),(0,a.CE)("p",Ln,[o[48]||(o[48]=(0,a.Lk)("b",null,"From: ",-1)),(0,a.eW)((0,h.v_)(e.from_user_online_id),1)])):(0,a.Q3)("",!0),"outgoing request"==e.type?((0,a.uX)(),(0,a.CE)("p",wn,[o[49]||(o[49]=(0,a.Lk)("b",null,"To: ",-1)),(0,a.eW)((0,h.v_)(e.to_user_online_id),1)])):(0,a.Q3)("",!0),(0,a.Lk)("p",null,[o[50]||(o[50]=(0,a.Lk)("b",null,"Status: ",-1)),(0,a.eW)((0,h.v_)(e.status),1)])])))),128)),0==r.friendRequestList.filter((e=>e.type==r.showRequestType&&e.status==r.showRequestStatus)).length?((0,a.uX)(),(0,a.CE)("li",Cn," No Requests ")):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",En,[o[56]||(o[56]=(0,a.Lk)("h2",null,"What your friends shared with you",-1)),(0,a.Lk)("ul",Pn,[0==r.receivedBooks.length?((0,a.uX)(),(0,a.CE)("li",Tn,"You have not been shared any books yet.")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.receivedBooks,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"received_book_li"},[(0,a.Lk)("img",{src:e.image,class:"received_user_book_img"},null,8,Xn),(0,a.Lk)("div",Fn,[(0,a.Lk)("p",Bn,[o[52]||(o[52]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(e.title||"Unavailable"),1)]),(0,a.Lk)("p",null,[o[53]||(o[53]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(e.published_date||"Unavailable"),1)]),(0,a.Lk)("ul",In,[o[54]||(o[54]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Authors: ")],-1)),e.authors&&0!==e.authors.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",Sn,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"text-align":"left"},key:o},[(0,a.Lk)("span",Mn,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("ul",Un,[o[55]||(o[55]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Genres: ")],-1)),e.categories&&0!==e.categories.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",On,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"received_book_genre"},(0,h.v_)(e),1)))),128))]),(0,a.Lk)("button",{onClick:o=>i.moreInfoReceived(e),class:"other_book_share_more_info_btn"},"More Info",8,qn)])])))),128))])]),1==r.showReceivedBook?((0,a.uX)(),(0,a.CE)("div",Rn,[(0,a.Lk)("div",Nn,[(0,a.Lk)("div",An,[(0,a.Lk)("h1",null,"Book shared from "+(0,h.v_)(r.chosenReceivedBook.from_user),1),(0,a.Lk)("button",{onClick:o[17]||(o[17]=e=>i.closeReceivedBook()),class:"close_btn"},"Close")]),(0,a.Lk)("div",Wn,[(0,a.Lk)("img",{src:r.chosenReceivedBook.image,class:"more_info_book_img"},null,8,Qn),(0,a.Lk)("div",Dn,[(0,a.Lk)("p",null,[o[57]||(o[57]=(0,a.Lk)("b",null,"Title: ",-1)),(0,a.eW)((0,h.v_)(r.chosenReceivedBook.title||"Unavailable"),1)]),(0,a.Lk)("p",null,[o[58]||(o[58]=(0,a.Lk)("b",null,"Published: ",-1)),(0,a.eW)((0,h.v_)(r.chosenReceivedBook.published_date||"Unavailable"),1)]),(0,a.Lk)("ul",xn,[o[59]||(o[59]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Authors: ")],-1)),r.chosenReceivedBook.authors&&0!==r.chosenReceivedBook.authors.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",Gn,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.chosenReceivedBook?.authors,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{style:{"text-align":"left"},key:o},[(0,a.Lk)("span",jn,(0,h.v_)(e.charAt(0)),1),(0,a.eW)((0,h.v_)(e.slice(1)),1)])))),128))]),(0,a.Lk)("ul",$n,[o[60]||(o[60]=(0,a.Lk)("p",{style:{"padding-right":"0.5rem"}},[(0,a.Lk)("b",null,"Genres: ")],-1)),r.chosenReceivedBook.categories&&0!==r.chosenReceivedBook.categories.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("li",Kn,"Unavailable")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.chosenReceivedBook.categories,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"more_info_info_genre"},(0,h.v_)(e),1)))),128))]),(0,a.Lk)("p",Vn,[o[61]||(o[61]=(0,a.Lk)("b",null,"Description: ",-1)),(0,a.eW)((0,h.v_)(r.chosenReceivedBook.description||"Unavailable"),1)])])])])])):(0,a.Q3)("",!0)])])}s(1701);var Hn={data(){return{query:"",userList:[],csrfToken:"",sortBy:"Most Common",minAge:null,maxAge:null,currentPage:1,totalPages:1,hasNext:!1,hasPrevious:!1,friendRequestList:[],friendshipList:[],showMoreInfo:!1,showShareBooks:!1,moreInfoBook:{},showRequestType:"incoming request",showRequestStatus:"pending",isLoading:!1,show_ChosenMedia:!1,chosenMedia:null,mediaList:[],sharedBooks:[],receivedBooks:[],showReceivedBook:!1,chosenReceivedBook:{}}},setup(){const e=Ge();return e.loadUser(),{userStore:e}},computed:{loggedUser(){return{id:this.userStore.user_id||null,online_id:this.userStore.online_id||null,favourite_genres:this.userStore.favourite_genres||[]}}},methods:{async fetch_csrf_token(){try{const e=await fetch("http://127.0.0.1:8000/csrf/",{method:"GET",credentials:"include"});if(e.ok){const o=await e.json();this.csrfToken=o.csrfToken,console.log(`Fetched csrf token: ${this.csrfToken}`)}else console.log(`Failed to fetch token, ${e.statusText}`)}catch(e){console.error(`Error fetching token, ${e}`)}},async search(e){this.isLoading=!0,this.show_ChosenMedia=!1,this.chosenMedia=null,1==e&&(this.currentPage=1,this.showPageMultiplier=1);try{const e=await fetch(`http://127.0.0.1:8000/search-book/?title=${this.query}&page=${this.currentPage}`);if(!e.ok)throw new Error("Failed to fetch data");const o=await e.json();this.mediaList=o.books||[],this.currentPage_book=o.current_page||1,this.totalPages_book=o.total_pages||1,console.log(o)}catch(o){console.error("error catching data",o)}this.isLoading=!1},async fetch_all_user(e=1){try{const o=new URLSearchParams;o.append("sort",this.sortBy.toString()),o.append("page",e.toString()),null!==this.minAge&&o.append("minAge",this.minAge),null!==this.maxAge&&o.append("maxAge",this.maxAge);const s=await fetch(`http://127.0.0.1:8000/user-list/?${o.toString()}`,{method:"GET",credentials:"include"});if(s.ok){const e=await s.json();this.userList=e.user_list.map((e=>({...e,showMore:!1}))),this.currentPage=e.current_page,this.totalPages=e.total_pages,this.hasNext=e.has_next,this.hasPrevious=e.has_previous}else console.log(`Failed to fetch user list, ${s.statusText}`)}catch(o){console.error(`Error fetching user list, ${o}`)}},async sendFriendRequest(e){try{const o=await fetch("http://127.0.0.1:8000/friend-request/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({friend_id:e}),credentials:"include"}),s=await o.json();this.fetch_friend_requests(),alert(s.message)}catch(o){console.error("Error sending request:",o)}},async fetch_friend_requests(){try{const e=await fetch("http://127.0.0.1:8000/friend-request/",{method:"GET",credentials:"include"});if(e.ok){const o=await e.json();this.friendRequestList=o}else console.log(`Failed to fetch friend requests, ${e.statusText}`)}catch(e){console.error(`Error fetching friend requests, ${e}`)}},async acceptRequest(e){try{const o=await fetch("http://127.0.0.1:8000/friend-request/",{method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({request_id:e,action:"accept"}),credentials:"include"});this.fetch_friend_requests(),this.fetch_all_user();const s=await o.json();alert(s.message)}catch(o){console.error("Error sending request:",o)}},async declineRequest(e){try{const o=await fetch("http://127.0.0.1:8000/friend-request/",{method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({request_id:e,action:"decline"}),credentials:"include"});this.fetch_friend_requests(),this.fetch_all_user();const s=await o.json();alert(s.message)}catch(o){console.error("Error sending request:",o)}},viewMore(e){0==e.is_friend?alert("You needs to be friends to view more info"):(e.showMore=!e.showMore,this.fetch_shared_books_with_user(e.id))},reset(){this.minAge=null,this.maxAge=null,this.sortBy="Most Common",this.fetch_all_user()},moreInfo(e){this.showMoreInfo=!0,this.showShareBooks=!1,this.moreInfoBook=e},backPage(){this.query="",this.showMoreInfo=!1,this.showShareBooks=!1,this.moreInfoBook=null},closeViewMore(e){e.showMore=!1,this.showMoreInfo=!1,this.showShareBooks=!1,this.sharedBooks=[],this.moreInfoBook=null},prevPage(){this.fetch_all_user(this.currentPage-1),window.scrollTo({top:0,behavior:"smooth"})},nextPage(){this.fetch_all_user(this.currentPage+1),window.scrollTo({top:0,behavior:"smooth"})},openShareBook(){this.showShareBooks=!0,this.showMoreInfo=!1,this.search(!0)},clearQuery(){this.currentPage_book=1,this.query="",this.mediaList=[],this.chosenMedia=null,this.show_ChosenMedia=!1,this.search(!0)},async share(e,o){let s={};s.id=o.id,s.image=o.volumeInfo?.imageLinks?.thumbnail,s.title=o.volumeInfo?.title,s.authors=o.volumeInfo?.authors,s.published_date=o.volumeInfo["publishedDate"]||"Not specified",s.categories=o.volumeInfo?.categories,s.description=o.volumeInfo?.description,s.from_user=this.loggedUser.online_id;try{const o=await fetch("http://127.0.0.1:8000/share-book/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({to_user_id:e,book:s}),credentials:"include"}),t=await o.json();t.error?alert(t.error):(alert(t.message),this.fetch_shared_books_with_user(e))}catch(t){console.error("Error sharing book:",t)}},async unshare(e,o){try{const s=await fetch("http://127.0.0.1:8000/share-book/",{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},body:JSON.stringify({to_user_id:e,book:o}),credentials:"include"}),t=await s.json();t.error?alert(t.error):(alert(t.message),this.fetch_shared_books_with_user(e))}catch(s){console.error("Error sharing book:",s)}},async fetch_shared_books_with_user(e){const o="sent books";try{const s=await fetch(`http://127.0.0.1:8000/share-book/?user_id=${e}&type=${o}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(!s.ok)throw new Error(`Failed to fetch books: ${s.status}`);const t=await s.json();this.sharedBooks=t.shared_books}catch(s){console.error("Error fetching book:",s)}},async fetch_received_books(){const e="received books";try{const o=await fetch(`http://127.0.0.1:8000/share-book/?type=${e}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":this.csrfToken},credentials:"include"});if(!o.ok)throw new Error(`Failed to fetch books: ${o.status}`);const s=await o.json();this.receivedBooks=s.received_books}catch(o){console.error("Error fetching book:",o)}},moreInfoReceived(e){this.chosenReceivedBook=e,this.showReceivedBook=!0},closeReceivedBook(){this.chosenReceivedBook={},this.showReceivedBook=!1}},mounted(){this.fetch_csrf_token(),this.fetch_all_user(),this.fetch_friend_requests(),this.fetch_received_books()}};const Yn=(0,l.A)(Hn,[["render",Jn]]);var zn=Yn;const Zn=[{path:"/",name:"Main Page",component:Ke},{path:"/dashboard",name:"Dashboard Page",component:Rs},{path:"/community",name:"Social Page",component:zn}],ea=(0,u.aE)({history:(0,u.LA)(),routes:Zn});var oa=ea;const sa=(0,t.Ef)(d),ta=(0,n.Ey)();sa.use(oa),sa.use(ta),sa.mount("#app")}},o={};function s(t){var n=o[t];if(void 0!==n)return n.exports;var a=o[t]={exports:{}};return e[t].call(a.exports,a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(o,t,n,a){if(!t){var r=1/0;for(d=0;d<e.length;d++){t=e[d][0],n=e[d][1],a=e[d][2];for(var i=!0,l=0;l<t.length;l++)(!1&a||r>=a)&&Object.keys(s.O).every((function(e){return s.O[e](t[l])}))?t.splice(l--,1):(i=!1,a<r&&(r=a));if(i){e.splice(d--,1);var c=n();void 0!==c&&(o=c)}}return o}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[t,n,a]}}(),function(){s.d=function(e,o){for(var t in o)s.o(o,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){var e={524:0};s.O.j=function(o){return 0===e[o]};var o=function(o,t){var n,a,r=t[0],i=t[1],l=t[2],c=0;if(r.some((function(o){return 0!==e[o]}))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var d=l(s)}for(o&&o(t);c<r.length;c++)a=r[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(d)},t=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];t.forEach(o.bind(null,0)),t.push=o.bind(null,t.push.bind(t))}();var t=s.O(void 0,[504],(function(){return s(1508)}));t=s.O(t)})();
//# sourceMappingURL=app.5330a68c.js.map